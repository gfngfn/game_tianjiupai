<!DOCTYPE html>
<html>
  <head>
    <title>tianjiupai</title>
    <script src="assets/main.js" type="text/javascript"></script>
  </head>
  <body>
    <div id="app">(Elm manipulates here)</div>
    <script type="text/javascript">
        var app = Elm.Main.init({
          node: document.getElementById("app"),
          flags: {{flags}}
        })

        var socket = new WebSocket('ws://localhost:8080/websocket');

        socket.onopen = () => {
          app.ports.sendWebSocketMessage.subscribe(function(message) {
              socket.send(message);
          });

          socket.addEventListener("message", function(event) {
              app.ports.receiveWebSocketMessage.send(event.data);
          });
        }
    </script>
  </body>
</html>
