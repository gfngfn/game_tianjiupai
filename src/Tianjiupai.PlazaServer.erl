-module('Tianjiupai.PlazaServer').
-export(['start_link'/0, 'as_pid'/1, 'get_all_rooms'/0, 'update_room'/1, 'delete_room_sync'/1, 'subscribe'/2, 'unsubscribe'/1]).
'start_link'() -> 'Tianjiupai.PlazaServer.Impl':'start_link_name'(ok, {'global', ok}).
'as_pid'(S1487Proc) -> 'Tianjiupai.PlazaServer.Impl':'as_pid'(S1487Proc).
'get_all_rooms'() -> begin {'ok', S1489Proc} = 'Tianjiupai.PlazaServer.Impl':'where_is_global'(ok), begin S1490Res = 'Tianjiupai.PlazaServer.Impl':'call'(S1489Proc, 'get_room_list'), case S1490Res of {'ok', {'room_list_got', S1491RoomSummaries}} -> sesterl_internal_prim:'return'(S1491RoomSummaries); {'error', _} -> sesterl_internal_prim:'return'([]) end end end.
'update_room'(S1493RoomSummary) -> begin {'ok', S1494Proc} = 'Tianjiupai.PlazaServer.Impl':'where_is_global'(ok), 'Tianjiupai.PlazaServer.Impl':'cast'(S1494Proc, {'update_room', S1493RoomSummary}) end.
'delete_room_sync'(S1496RoomId) -> begin {'ok', S1497Proc} = 'Tianjiupai.PlazaServer.Impl':'where_is_global'(ok), begin S1498Res = 'Tianjiupai.PlazaServer.Impl':'call'(S1497Proc, {'delete_room_sync', S1496RoomId}), case S1498Res of {'ok', 'room_deleted'} -> begin _ = begin S2885 = 'Tianjiupai.Logger':'debug'({"room deleted (room_id: ~s)", 1}, {S1496RoomId}), S2885(<<"PlazaServer.sest">>, 301) end, sesterl_internal_prim:'return'(ok) end; {'error', S1499Err} -> begin _ = begin S2886 = 'Tianjiupai.Logger':'warning'({"delete room failed (room_id: ~s, reason: ~p)", 2}, {S1496RoomId, S1499Err}), S2886(<<"PlazaServer.sest">>, 305) end, sesterl_internal_prim:'return'(ok) end end end end.
'subscribe'(S1501UserId, S1502WsProc) -> begin {'ok', S1503Proc} = 'Tianjiupai.PlazaServer.Impl':'where_is_global'(ok), 'Tianjiupai.PlazaServer.Impl':'cast'(S1503Proc, {'subscribe', S1501UserId, S1502WsProc}) end.
'unsubscribe'(S1505UserId) -> begin {'ok', S1506Proc} = 'Tianjiupai.PlazaServer.Impl':'where_is_global'(ok), 'Tianjiupai.PlazaServer.Impl':'cast'(S1506Proc, {'unsubscribe', S1505UserId}) end.
